syntax = "proto3";

package search;

service SearchService {
  rpc HandleProductSearch (SearchProductRequest) returns (SearchProductResponse);
  rpc HandleProductSearchInventory (SearchProductRequest) returns (SearchProductResponse);
  rpc HandleOrdersSearch (SearchOrderRequest) returns (SearchOrderResponse);
}

message Empty {}

message OrderItem {
  int32 id = 1;                 
  string orderId = 2;           
  string productId = 3;         
  string productName = 4;       
  string productSku = 5;        
  int32 quantity = 6;           
  string price = 7;             
}

message SearchProductRequest {
  optional int32 from = 1;
  optional int32 size = 2;
  optional string valueSearch = 3;
}

message SearchOrderRequest {
  optional int32 from = 1;
  optional int32 size = 2;
  optional string valueSearch = 3;
  string activeTab = 4;
}

message Order {
  string id = 1;                
  int32 userId = 2;             
  string totalAmount = 3;       
  string status = 4;       
  repeated OrderItem items = 5; 
  string createdAt = 6;         
}

message SearchOrderResponse {
  repeated Order orders = 1;
}

message ProductVariant {
  string sku = 1;
  double price = 2;
  optional string image_url = 3;
  repeated VariantAttribute attributes = 4;
  int32 stock_snapshot = 5;
  double original_price = 6;
}

message VariantAttribute {
  string k = 1;
  string v = 2;
}

message SpecificationItem {
  string key = 1;
  string value = 2;
}

message ProductResponse {
  string id = 1;       
  string name = 2;
  string description = 3;
  string thumbnail_url = 6;
  bool is_active = 7;
  int32 user_id = 8;
  
  // Quan hệ (Populate) trả về Object hoặc String tùy logic
  string brand_name = 9;   
  string category_name = 10;
  
  int32 view_count = 11;
  int32 likes_count = 12;
  string created_at = 13;
  repeated SpecificationItem specifications = 14;
  repeated ProductVariant variants = 15;

  double min_price = 16;
  double max_price = 17;
}

message SearchProductResponse {
  repeated ProductResponse products = 1;
}